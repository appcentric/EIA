<?xml version="1.0" encoding="UTF-8" ?>
<xsl:stylesheet version="1.0"
                xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
                xmlns:oraxsl="http://www.oracle.com/XSL/Transform/java"
                xmlns:mhdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.mediator.service.common.functions.MediatorExtnFunction"
                xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xmlns:oracle-xsl-mapper="http://www.oracle.com/xsl/mapper/schemas"
                xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue"
                xmlns:ns0="http://xmlns.eia.com/AO/EBiz/P2P/InvoiceABM/1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
                xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                xmlns:utl="http://www.oracle.com/XSL/Transform/java/com.eia.soa.util.Configuration"
                xmlns:top="http://xmlns.oracle.com/pcbpel/adapter/db/top/OA_CreateInvoiceEBS"
                xmlns:socket="http://www.oracle.com/XSL/Transform/java/oracle.tip.adapter.socket.ProtocolTranslator"
                exclude-result-prefixes="xsi oracle-xsl-mapper xsl xsd ns0 tns xp20 oraxsl mhdr oraext dvm xref utl socket"
                xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/"
                xmlns:plt="http://schemas.xmlsoap.org/ws/2003/05/partner-link/"
                xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:mime="http://schemas.xmlsoap.org/wsdl/mime/"
                xmlns:ns1="http://xmlns.eia.com/ABS/EBiz/InvoiceABS/1.0" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
                xmlns:ns2="http://xmlns.oracle.com/pcbpel/adapter/apps/WI_Applications/NUC_EBizAPInvoice_ABS/OA_CreateInvoiceEBS"
                xmlns:core="http://xmlns.eia.com/EO/Common/1.0"
                xmlns:ns9="http://xmlns.eia.com/AO/EBiz/common/WhoAO/1.0"
                xmlns:ns8="http://xmlns.eia.com/AO/EBiz/common/OperationResultAO/1.0"
                xmlns:ns4="http://xmlns.eia.com/AO/EBiz/P2P/OrganizationAO/1.0"
                xmlns:ns3="http://xmlns.eia.com/AO/EBiz/P2P/InvoiceAO/1.0"
                xmlns:ns10="http://xmlns.eia.com/AO/EBiz/common/AmountAO/1.0"
                xmlns:ns11="http://xmlns.eia.com/AO/EBiz/common/AppsContextAO/1.0"
                xmlns:ns7="http://xmlns.eia.com/AO/EBiz/common/CommonAO/1.0"
                xmlns:ns6="http://xmlns.eia.com/AO/EBiz/P2P/SupplierAO/1.0"
                xmlns:ns5="http://xmlns.eia.com/AO/EBiz/P2P/SupplierSiteAO/1.0">
  <oracle-xsl-mapper:schema>
    <!--SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY.-->
    <oracle-xsl-mapper:mapSources>
      <oracle-xsl-mapper:source type="WSDL">
        <oracle-xsl-mapper:schema location="oramds:/apps/EIAMetadata/ABS/EBiz/V1.0/P2P/InvoiceABS.wsdl"/>
        <oracle-xsl-mapper:rootElement name="CreateListOfInvoicesRequestMessage"
                                       namespace="http://xmlns.eia.com/AO/EBiz/P2P/InvoiceABM/1.0"/>
      </oracle-xsl-mapper:source>
    </oracle-xsl-mapper:mapSources>
    <oracle-xsl-mapper:mapTargets>
      <oracle-xsl-mapper:target type="WSDL">
        <oracle-xsl-mapper:schema location="../OA_CreateInvoiceEBS.wsdl"/>
        <oracle-xsl-mapper:rootElement name="ApInvoicesInterfaceCollection"
                                       namespace="http://xmlns.oracle.com/pcbpel/adapter/db/top/OA_CreateInvoiceEBS"/>
      </oracle-xsl-mapper:target>
    </oracle-xsl-mapper:mapTargets>
    <!--GENERATED BY ORACLE XSL MAPPER 12.1.3.0.0(XSLT Build 140529.0700.0211) AT [TUE NOV 10 16:54:04 CST 2015].-->
  </oracle-xsl-mapper:schema>
  <!--User Editing allowed BELOW this line - DO NOT DELETE THIS LINE-->
  <xsl:template match="/">
    <top:ApInvoicesInterfaceCollection>
      <xsl:for-each select="/ns0:CreateListOfInvoicesRequestMessage/ns0:Invoice/ns3:Invoice">
        <top:ApInvoicesInterface>
          <top:invoiceId>
            <xsl:value-of select='oraext:sequence-next-val("AP_INVOICES_INTERFACE_S","jdbc/ebsapps")'/>
          </top:invoiceId>
          <xsl:if test="ns3:invoiceNum">
          <top:invoiceNum>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Invoicenum/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Invoicenum"/>
          </top:invoiceNum>
          </xsl:if>
          <xsl:if test="ns3:Invoicetypelookupcode">
          <top:invoiceTypeLookupCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Invoicetypelookupcode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Invoicetypelookupcode"/>
          </top:invoiceTypeLookupCode>
          </xsl:if>
          <xsl:if test="ns3:Invoicedate">
          <top:invoiceDate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Invoicedate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Invoicedate"/>
          </top:invoiceDate>
          </xsl:if>
          <xsl:if test="ns3:Ponumber">
          <top:poNumber>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Ponumber/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Ponumber"/>
          </top:poNumber>
          </xsl:if>
          <xsl:if test="ns3:Vendorid">
          <top:vendorId>
            <xsl:attribute name="xsi:nil"/>
            <xsl:value-of select="ns3:Vendorid"/>
          </top:vendorId>
          </xsl:if>
          <xsl:if test="ns3:Vendornum">
          <top:vendorNum>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Vendornum/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Vendornum"/>
          </top:vendorNum>
          </xsl:if>
          <xsl:if test="ns3:Vendorname">
          <top:vendorName>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Vendorname/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Vendorname"/>
          </top:vendorName>
          </xsl:if>
          <xsl:if test="ns3:Vendorsiteid">
          <top:vendorSiteId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Vendorsiteid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Vendorsiteid"/>
          </top:vendorSiteId>
          </xsl:if>
          <xsl:if test="ns3:Vendorsitecode">
          <top:vendorSiteCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Vendorsitecode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Vendorsitecode"/>
          </top:vendorSiteCode>
          </xsl:if>
          <xsl:if test="ns3:Invoiceamount">
          <top:invoiceAmount>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Invoiceamount/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Invoiceamount"/>
          </top:invoiceAmount>
          </xsl:if>
          <xsl:if test="ns3:Invoicecurrencycode">
          <top:invoiceCurrencyCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Invoicecurrencycode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Invoicecurrencycode"/>
          </top:invoiceCurrencyCode>
          </xsl:if>
          <xsl:if test="ns3:Exchangerate">
          <top:exchangeRate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Exchangerate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Exchangerate"/>
          </top:exchangeRate>
          </xsl:if>
          <xsl:if test="ns3:Exchangeratetype">
          <top:exchangeRateType>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Exchangeratetype/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Exchangeratetype"/>
          </top:exchangeRateType>
          </xsl:if>
          <xsl:if test="ns3:Exchangedate">
          <top:exchangeDate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Exchangedate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Exchangedate"/>
          </top:exchangeDate>
          </xsl:if>
          <xsl:if test="ns3:Termsid">
          <top:termsId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Termsid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Termsid"/>
          </top:termsId>
          </xsl:if>
          <xsl:if test="ns3:Termsname">
          <top:termsName>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Termsname/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Termsname"/>
          </top:termsName>
          </xsl:if>
          <xsl:if test="ns3:Description">
          <top:description>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Description/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Description"/>
          </top:description>
          </xsl:if>
          <xsl:if test="ns3:Awtgroupid">
          <top:awtGroupId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Awtgroupid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Awtgroupid"/>
          </top:awtGroupId>
          </xsl:if>
          <xsl:if test="ns3:Awtgroupname">
          <top:awtGroupName>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Awtgroupname/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Awtgroupname"/>
          </top:awtGroupName>
          </xsl:if>
          <top:lastUpdateDate>
            <xsl:value-of select="xp20:current-dateTime()"/>
          </top:lastUpdateDate>
          <top:lastUpdatedBy>
            <xsl:value-of select='dvm:lookupValue("oramds:/apps/EIAMetadata/CommonArtifacts/dvm/EBS_USER_NAME_DIVISION_MAP.dvm","DIVISION","Yamato","EBS_USER_ID","")'/>
          </top:lastUpdatedBy>
          <top:creationDate>
            <xsl:value-of select="xp20:current-dateTime()"/>
          </top:creationDate>
          <top:createdBy>
            <xsl:value-of select='dvm:lookupValue("oramds:/apps/EIAMetadata/CommonArtifacts/dvm/EBS_USER_NAME_DIVISION_MAP.dvm","DIVISION","Yamato","EBS_USER_ID","")'/>
          </top:createdBy>
          <xsl:if test="ns3:HeaderDFF/ns2:AttributeCategory">
            <top:attributeCategory>
              <xsl:if test="ns3:HeaderDFF/ns2:AttributeCategory/@xsi:nil">
                <xsl:attribute name="xsi:nil">
                  <xsl:value-of select="ns3:HeaderDFF/ns2:AttributeCategory/@xsi:nil"/>
                </xsl:attribute>
              </xsl:if>
              <xsl:value-of select="ns3:HeaderDFF/ns2:AttributeCategory"/>
            </top:attributeCategory>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute1">
          <top:attribute1>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute1/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute1"/>
          </top:attribute1>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute2">
          <top:attribute2>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute2/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute2"/>
          </top:attribute2>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute3">
          <top:attribute3>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute3/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute3"/>
          </top:attribute3>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute4">
          <top:attribute4>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute4/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute4"/>
          </top:attribute4>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute5">
          <top:attribute5>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute5/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute5"/>
          </top:attribute5>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute6">
          <top:attribute6>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute6/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute6"/>
          </top:attribute6>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute7">
          <top:attribute7>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute7/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute7"/>
          </top:attribute7>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute8">
          <top:attribute8>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute8/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute8"/>
          </top:attribute8>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute9">
          <top:attribute9>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute9/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute9"/>
          </top:attribute9>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute10">
          <top:attribute10>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute10/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute10"/>
          </top:attribute10>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute11">
          <top:attribute11>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute11/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute11"/>
          </top:attribute11>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute12">
          <top:attribute12>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute12/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute12"/>
          </top:attribute12>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute13">
          <top:attribute13>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute13/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute13"/>
          </top:attribute13>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute14">
          <top:attribute14>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute14/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute14"/>
          </top:attribute14>
          </xsl:if>
          <xsl:if test="ns3:HeaderDFF/ns2:Attribute15">
          <top:attribute15>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute15/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:HeaderDFF/ns2:Attribute15"/>
          </top:attribute15>
          </xsl:if>
          <xsl:if test="ns3:Status">
          <top:status>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Status/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Status"/>
          </top:status>
          </xsl:if>
          <xsl:if test="ns3:Source">
          <top:source>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Source/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Source"/>
          </top:source>
          </xsl:if>
          <xsl:if test="ns3:Groupid">
          <top:groupId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Groupid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Groupid"/>
          </top:groupId>
          </xsl:if>
          <xsl:if test="ns3:Requestid">
          <top:requestId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Requestid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Requestid"/>
          </top:requestId>
          </xsl:if>
          <xsl:if test="ns3:Paymentcrossratetype">
          <top:paymentCrossRateType>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paymentcrossratetype/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paymentcrossratetype"/>
          </top:paymentCrossRateType>
          </xsl:if>
          <xsl:if test="ns3:Paymentcrossratedate">
          <top:paymentCrossRateDate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paymentcrossratedate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paymentcrossratedate"/>
          </top:paymentCrossRateDate>
          </xsl:if>
          <xsl:if test="ns3:Paymentcrossrate">
          <top:paymentCrossRate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paymentcrossrate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paymentcrossrate"/>
          </top:paymentCrossRate>
          </xsl:if>
          <xsl:if test="ns3:Paymentcurrencycode">
          <top:paymentCurrencyCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paymentcurrencycode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paymentcurrencycode"/>
          </top:paymentCurrencyCode>
          </xsl:if>
          <xsl:if test="ns3:Workflowflag">
          <top:workflowFlag>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Workflowflag/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Workflowflag"/>
          </top:workflowFlag>
          </xsl:if>
          <xsl:if test="ns3:Doccategorycode">
          <top:docCategoryCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Doccategorycode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Doccategorycode"/>
          </top:docCategoryCode>
          </xsl:if>
          <xsl:if test="ns3:Vouchernum">
          <top:voucherNum>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Vouchernum/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Vouchernum"/>
          </top:voucherNum>
          </xsl:if>
          <xsl:if test="ns3:Paymentmethodlookupcode">
          <top:paymentMethodLookupCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paymentmethodlookupcode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paymentmethodlookupcode"/>
          </top:paymentMethodLookupCode>
          </xsl:if>
          <xsl:if test="ns3:Paygrouplookupcode">
          <top:payGroupLookupCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paygrouplookupcode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paygrouplookupcode"/>
          </top:payGroupLookupCode>
          </xsl:if>
          <xsl:if test="ns3:Goodsreceiveddate">
          <top:goodsReceivedDate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Goodsreceiveddate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Goodsreceiveddate"/>
          </top:goodsReceivedDate>
          </xsl:if>
          <xsl:if test="ns3:Invoicereceiveddate">
          <top:invoiceReceivedDate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Invoicereceiveddate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Invoicereceiveddate"/>
          </top:invoiceReceivedDate>
          </xsl:if>
          <xsl:if test="ns3:Gldate">
          <top:glDate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Gldate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Gldate"/>
          </top:glDate>
          </xsl:if>
          <xsl:if test="ns3:Acctspaycodecombinationid">
          <top:acctsPayCodeCombinationId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Acctspaycodecombinationid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Acctspaycodecombinationid"/>
          </top:acctsPayCodeCombinationId>
          </xsl:if>
          <xsl:if test="ns3:Ussgltransactioncode">
          <top:ussglTransactionCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Ussgltransactioncode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Ussgltransactioncode"/>
          </top:ussglTransactionCode>
          </xsl:if>
          <xsl:if test="ns3:Exclusivepaymentflag">
          <top:exclusivePaymentFlag>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Exclusivepaymentflag/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Exclusivepaymentflag"/>
          </top:exclusivePaymentFlag>
          </xsl:if>
          <xsl:if test="ns3:Orgid">
          <top:orgId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Orgid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Orgid"/>
          </top:orgId>
          </xsl:if>
          <xsl:if test="ns3:Amountapplicabletodiscount">
          <top:amountApplicableToDiscount>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Amountapplicabletodiscount/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Amountapplicabletodiscount"/>
          </top:amountApplicableToDiscount>
          </xsl:if>
          <xsl:if test="ns3:Prepaynum">
          <top:prepayNum>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Prepaynum/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Prepaynum"/>
          </top:prepayNum>
          </xsl:if>
          <xsl:if test="ns3:Prepaydistnum">
          <top:prepayDistNum>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Prepaydistnum/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Prepaydistnum"/>
          </top:prepayDistNum>
          </xsl:if>
          <xsl:if test="ns3:Prepayapplyamount">
          <top:prepayApplyAmount>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Prepayapplyamount/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Prepayapplyamount"/>
          </top:prepayApplyAmount>
          </xsl:if>
          <xsl:if test="ns3:Prepaygldate">
          <top:prepayGlDate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Prepaygldate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Prepaygldate"/>
          </top:prepayGlDate>
          </xsl:if>
          <xsl:if test="ns3:Invoiceincludesprepayflag">
          <top:invoiceIncludesPrepayFlag>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Invoiceincludesprepayflag/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Invoiceincludesprepayflag"/>
          </top:invoiceIncludesPrepayFlag>
          </xsl:if>
          <xsl:if test="ns3:Noxratebaseamount">
          <top:noXrateBaseAmount>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Noxratebaseamount/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Noxratebaseamount"/>
          </top:noXrateBaseAmount>
          </xsl:if>
          <xsl:if test="ns3:Vendoremailaddress">
          <top:vendorEmailAddress>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Vendoremailaddress/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Vendoremailaddress"/>
          </top:vendorEmailAddress>
          </xsl:if>
          <xsl:if test="ns3:Termsdate">
          <top:termsDate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Termsdate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Termsdate"/>
          </top:termsDate>
          </xsl:if>
          <xsl:if test="ns3:Requesterid">
          <top:requesterId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Requesterid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Requesterid"/>
          </top:requesterId>
          </xsl:if>
          <xsl:if test="ns3:Shiptolocation">
          <top:shipToLocation>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Shiptolocation/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Shiptolocation"/>
          </top:shipToLocation>
          </xsl:if>
          <xsl:if test="ns3:Externaldocref">
          <top:externalDocRef>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Externaldocref/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Externaldocref"/>
          </top:externalDocRef>
          </xsl:if>
          <xsl:if test="ns3:Prepaylinenum">
          <top:prepayLineNum>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Prepaylinenum/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Prepaylinenum"/>
          </top:prepayLineNum>
          </xsl:if>
          <xsl:if test="ns3:Requesterfirstname">
          <top:requesterFirstName>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Requesterfirstname/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Requesterfirstname"/>
          </top:requesterFirstName>
          </xsl:if>
          <xsl:if test="ns3:Requesterlastname">
          <top:requesterLastName>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Requesterlastname/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Requesterlastname"/>
          </top:requesterLastName>
          </xsl:if>
          <xsl:if test="ns3:Applicationid">
          <top:applicationId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Applicationid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Applicationid"/>
          </top:applicationId>
          </xsl:if>
          <xsl:if test="ns3:Producttable">
          <top:productTable>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Producttable/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Producttable"/>
          </top:productTable>
          </xsl:if>
          <xsl:if test="ns3:Referencekey1">
          <top:referenceKey1>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Referencekey1/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Referencekey1"/>
          </top:referenceKey1>
          </xsl:if>
          <xsl:if test="ns3:Referencekey2">
          <top:referenceKey2>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Referencekey2/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Referencekey2"/>
          </top:referenceKey2>
          </xsl:if>
          <xsl:if test="ns3:Referencekey3">
          <top:referenceKey3>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Referencekey3/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Referencekey3"/>
          </top:referenceKey3>
          </xsl:if>
          <xsl:if test="ns3:Referencekey4">
          <top:referenceKey4>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Referencekey4/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Referencekey4"/>
          </top:referenceKey4>
          </xsl:if>
          <xsl:if test="ns3:Referencekey5">
          <top:referenceKey5>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Referencekey5/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Referencekey5"/>
          </top:referenceKey5>
          </xsl:if>
          <xsl:if test="ns3:Applyadvancesflag">
          <top:applyAdvancesFlag>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Applyadvancesflag/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Applyadvancesflag"/>
          </top:applyAdvancesFlag>
          </xsl:if>
          <xsl:if test="ns3:Calctaxduringimportflag">
          <top:calcTaxDuringImportFlag>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Calctaxduringimportflag/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Calctaxduringimportflag"/>
          </top:calcTaxDuringImportFlag>
          </xsl:if>
          <xsl:if test="ns3:Controlamount">
          <top:controlAmount>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Controlamount/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Controlamount"/>
          </top:controlAmount>
          </xsl:if>
          <xsl:if test="ns3:Addtaxtoinvamtflag">
          <top:addTaxToInvAmtFlag>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Addtaxtoinvamtflag/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Addtaxtoinvamtflag"/>
          </top:addTaxToInvAmtFlag>
          </xsl:if>
          <xsl:if test="ns3:Taxrelatedinvoiceid">
          <top:taxRelatedInvoiceId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Taxrelatedinvoiceid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Taxrelatedinvoiceid"/>
          </top:taxRelatedInvoiceId>
          </xsl:if>
          <xsl:if test="ns3:Taxationcountry">
          <top:taxationCountry>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Taxationcountry/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Taxationcountry"/>
          </top:taxationCountry>
          </xsl:if>
          <xsl:if test="ns3:Documentsubtype">
          <top:documentSubType>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Documentsubtype/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Documentsubtype"/>
          </top:documentSubType>
          </xsl:if>
          <xsl:if test="ns3:Suppliertaxinvoicenumber">
          <top:supplierTaxInvoiceNumber>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Suppliertaxinvoicenumber/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Suppliertaxinvoicenumber"/>
          </top:supplierTaxInvoiceNumber>
          </xsl:if>
          <xsl:if test="ns3:Suppliertaxinvoicedate">
          <top:supplierTaxInvoiceDate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Suppliertaxinvoicedate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Suppliertaxinvoicedate"/>
          </top:supplierTaxInvoiceDate>
          </xsl:if>
          <xsl:if test="ns3:Suppliertaxexchangerate">
          <top:supplierTaxExchangeRate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Suppliertaxexchangerate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Suppliertaxexchangerate"/>
          </top:supplierTaxExchangeRate>
          </xsl:if>
          <xsl:if test="ns3:Taxinvoicerecordingdate">
          <top:taxInvoiceRecordingDate>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Taxinvoicerecordingdate/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Taxinvoicerecordingdate"/>
          </top:taxInvoiceRecordingDate>
          </xsl:if>
          <xsl:if test="ns3:Taxinvoiceinternalseq">
          <top:taxInvoiceInternalSeq>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Taxinvoiceinternalseq/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Taxinvoiceinternalseq"/>
          </top:taxInvoiceInternalSeq>
          </xsl:if>
          <xsl:if test="ns3:Legalentityid">
          <top:legalEntityId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Legalentityid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Legalentityid"/>
          </top:legalEntityId>
          </xsl:if>
          <xsl:if test="ns3:Legalentityname">
          <top:legalEntityName>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Legalentityname/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Legalentityname"/>
          </top:legalEntityName>
          </xsl:if>
          <xsl:if test="ns3:Reference1">
          <top:reference1>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Reference1/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Reference1"/>
          </top:reference1>
          </xsl:if>
          <xsl:if test="ns3:Reference2">
          <top:reference2>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Reference2/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Reference2"/>
          </top:reference2>
          </xsl:if>
          <xsl:if test="ns3:Operatingunit">
          <top:operatingUnit>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Operatingunit/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Operatingunit"/>
          </top:operatingUnit>
          </xsl:if>
          <xsl:if test="ns3:Bankchargebearer">
          <top:bankChargeBearer>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Bankchargebearer/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Bankchargebearer"/>
          </top:bankChargeBearer>
          </xsl:if>
          <xsl:if test="ns3:Remittancemessage1">
          <top:remittanceMessage1>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Remittancemessage1/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Remittancemessage1"/>
          </top:remittanceMessage1>
          </xsl:if>
          <xsl:if test="ns3:Remittancemessage2">
          <top:remittanceMessage2>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Remittancemessage2/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Remittancemessage2"/>
          </top:remittanceMessage2>
          </xsl:if>
          <xsl:if test="ns3:Remittancemessage3">
          <top:remittanceMessage3>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Remittancemessage3/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Remittancemessage3"/>
          </top:remittanceMessage3>
          </xsl:if>
          <xsl:if test="ns3:Uniqueremittanceidentifier">
          <top:uniqueRemittanceIdentifier>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Uniqueremittanceidentifier/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Uniqueremittanceidentifier"/>
          </top:uniqueRemittanceIdentifier>
          </xsl:if>
          <xsl:if test="ns3:Uricheckdigit">
          <top:uriCheckDigit>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Uricheckdigit/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Uricheckdigit"/>
          </top:uriCheckDigit>
          </xsl:if>
          <xsl:if test="ns3:Settlementpriority">
          <top:settlementPriority>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Settlementpriority/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Settlementpriority"/>
          </top:settlementPriority>
          </xsl:if>
          <xsl:if test="ns3:Paymentreasoncode">
          <top:paymentReasonCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paymentreasoncode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paymentreasoncode"/>
          </top:paymentReasonCode>
          </xsl:if>
          <xsl:if test="ns3:Paymentreasoncomments">
          <top:paymentReasonComments>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paymentreasoncomments/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paymentreasoncomments"/>
          </top:paymentReasonComments>
          </xsl:if>
          <xsl:if test="ns3:Paymentmethodcode">
          <top:paymentMethodCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paymentmethodcode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paymentmethodcode"/>
          </top:paymentMethodCode>
          </xsl:if>
          <xsl:if test="ns3:Deliverychannelcode">
          <top:deliveryChannelCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Deliverychannelcode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Deliverychannelcode"/>
          </top:deliveryChannelCode>
          </xsl:if>
          <xsl:if test="ns3:Paidonbehalfemployeeid">
          <top:paidOnBehalfEmployeeId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paidonbehalfemployeeid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paidonbehalfemployeeid"/>
          </top:paidOnBehalfEmployeeId>
          </xsl:if>
          <xsl:if test="ns3:Netofretainageflag">
          <top:netOfRetainageFlag>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Netofretainageflag/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Netofretainageflag"/>
          </top:netOfRetainageFlag>
          </xsl:if>
          <xsl:if test="ns3:Requesteremployeenum">
          <top:requesterEmployeeNum>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Requesteremployeenum/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Requesteremployeenum"/>
          </top:requesterEmployeeNum>
          </xsl:if>
          <xsl:if test="ns3:Custregistrationcode">
          <top:custRegistrationCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Custregistrationcode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Custregistrationcode"/>
          </top:custRegistrationCode>
          </xsl:if>
          <xsl:if test="ns3:Custregistrationnumber">
          <top:custRegistrationNumber>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Custregistrationnumber/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Custregistrationnumber"/>
          </top:custRegistrationNumber>
          </xsl:if>
          <xsl:if test="ns3:Partyid">
          <top:partyId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Partyid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Partyid"/>
          </top:partyId>
          </xsl:if>
          <xsl:if test="ns3:Partysiteid">
          <top:partySiteId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Partysiteid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Partysiteid"/>
          </top:partySiteId>
          </xsl:if>
          <xsl:if test="ns3:Payproctrxntypecode">
          <top:payProcTrxnTypeCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Payproctrxntypecode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Payproctrxntypecode"/>
          </top:payProcTrxnTypeCode>
          </xsl:if>
          <xsl:if test="ns3:Paymentfunction">
          <top:paymentFunction>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paymentfunction/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paymentfunction"/>
          </top:paymentFunction>
          </xsl:if>
          <xsl:if test="ns3:Paymentpriority">
          <top:paymentPriority>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Paymentpriority/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Paymentpriority"/>
          </top:paymentPriority>
          </xsl:if>
          <xsl:if test="ns3:Portofentrycode">
          <top:portOfEntryCode>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Portofentrycode/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Portofentrycode"/>
          </top:portOfEntryCode>
          </xsl:if>
          <xsl:if test="ns3:Externalbankaccountid">
          <top:externalBankAccountId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Externalbankaccountid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Externalbankaccountid"/>
          </top:externalBankAccountId>
          </xsl:if>
          <xsl:if test="ns3:Acctspaycodeconcatenated">
          <top:acctsPayCodeConcatenated>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Acctspaycodeconcatenated/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Acctspaycodeconcatenated"/>
          </top:acctsPayCodeConcatenated>
          </xsl:if>
          <xsl:if test="ns3:Payawtgroupid">
          <top:payAwtGroupId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Payawtgroupid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Payawtgroupid"/>
          </top:payAwtGroupId>
          </xsl:if>
          <xsl:if test="ns3:Payawtgroupname">
          <top:payAwtGroupName>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Payawtgroupname/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Payawtgroupname"/>
          </top:payAwtGroupName>
          </xsl:if>
          <xsl:if test="ns3:Originalinvoiceamount">
          <top:originalInvoiceAmount>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Originalinvoiceamount/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Originalinvoiceamount"/>
          </top:originalInvoiceAmount>
          </xsl:if>
          <xsl:if test="ns3:Disputereason">
          <top:disputeReason>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Disputereason/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Disputereason"/>
          </top:disputeReason>
          </xsl:if>
          <xsl:if test="ns3:RemitToSupplier/ns1:SupplierName">
          <top:remitToSupplierName>
            <xsl:value-of select="ns3:RemitToSupplier/ns1:SupplierName"/>
          </top:remitToSupplierName>
          </xsl:if>
          <xsl:if test="ns3:Remittosupplierid">
          <top:remitToSupplierId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Remittosupplierid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Remittosupplierid"/>
          </top:remitToSupplierId>
          </xsl:if>
          <xsl:if test="ns3:Remittosuppliersite">
          <top:remitToSupplierSite>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Remittosuppliersite/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Remittosuppliersite"/>
          </top:remitToSupplierSite>
          </xsl:if>
          <xsl:if test="ns3:Remittosuppliersiteid">
          <top:remitToSupplierSiteId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Remittosuppliersiteid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Remittosuppliersiteid"/>
          </top:remitToSupplierSiteId>
          </xsl:if>
          <xsl:if test="ns3:Relationshipid">
          <top:relationshipId>
            <xsl:attribute name="xsi:nil">
              <xsl:value-of select="ns3:Relationshipid/@xsi:nil"/>
            </xsl:attribute>
            <xsl:value-of select="ns3:Relationshipid"/>
          </top:relationshipId>
          </xsl:if>
          <xsl:if test="ns3:RemitToSupplier/ns1:SupplierNumber">
          <top:remitToSupplierNum>
            <xsl:value-of select="ns3:RemitToSupplier/ns1:SupplierNumber"/>
          </top:remitToSupplierNum>
          </xsl:if>
          <top:apInvoiceLinesInterfaceCollection>
            <xsl:for-each select="ns3:ListOfInvoiceLines/ns3:InvoiceLines">
              <top:ApInvoiceLinesInterface>
                <top:invoiceLineId>
                  <xsl:value-of select='oraext:sequence-next-val("AP_INVOICE_LINES_INTERFACE_S","jdbc/ebsapps")'/>
                </top:invoiceLineId>
                <xsl:if test="ns3:Linenumber">
                <top:lineNumber>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Linenumber/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Linenumber"/>
                </top:lineNumber>
                </xsl:if>
                <xsl:if test="ns3:Linetypelookupcode">
                <top:lineTypeLookupCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Linetypelookupcode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Linetypelookupcode"/>
                </top:lineTypeLookupCode>
                </xsl:if>
                <xsl:if test="ns3:Linegroupnumber">
                <top:lineGroupNumber>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Linegroupnumber/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Linegroupnumber"/>
                </top:lineGroupNumber>
                </xsl:if>
                <xsl:if test="ns3:Amount">
                <top:amount>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Amount/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Amount"/>
                </top:amount>
                </xsl:if>
                <xsl:if test="ns3:Accountingdate">
                <top:accountingDate>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Accountingdate/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Accountingdate"/>
                </top:accountingDate>
                </xsl:if>
                <xsl:if test="ns3:Description">
                <top:description>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Description/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Description"/>
                </top:description>
                </xsl:if>
                <xsl:if test="ns3:Amountincludestaxflag">
                <top:amountIncludesTaxFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Amountincludestaxflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Amountincludestaxflag"/>
                </top:amountIncludesTaxFlag>
                </xsl:if>
                <xsl:if test="ns3:Prorateacrossflag">
                <top:prorateAcrossFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Prorateacrossflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Prorateacrossflag"/>
                </top:prorateAcrossFlag>
                </xsl:if>
                <xsl:if test="ns3:Taxcode">
                <top:taxCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxcode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxcode"/>
                </top:taxCode>
                </xsl:if>
                <xsl:if test="ns3:Finalmatchflag">
                <top:finalMatchFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Finalmatchflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Finalmatchflag"/>
                </top:finalMatchFlag>
                </xsl:if>
                <xsl:if test="ns3:Poheaderid">
                <top:poHeaderId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Poheaderid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Poheaderid"/>
                </top:poHeaderId>
                </xsl:if>
                <xsl:if test="ns3:Ponumber">
                <top:poNumber>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Ponumber/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Ponumber"/>
                </top:poNumber>
                </xsl:if>
                <xsl:if test="ns3:Polineid">
                <top:poLineId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Polineid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Polineid"/>
                </top:poLineId>
                </xsl:if>
                <xsl:if test="ns3:Polinenumber">
                <top:poLineNumber>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Polinenumber/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Polinenumber"/>
                </top:poLineNumber>
                </xsl:if>
                <xsl:if test="ns3:Polinelocationid">
                <top:poLineLocationId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Polinelocationid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Polinelocationid"/>
                </top:poLineLocationId>
                </xsl:if>
                <xsl:if test="ns3:Poshipmentnum">
                <top:poShipmentNum>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Poshipmentnum/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Poshipmentnum"/>
                </top:poShipmentNum>
                </xsl:if>
                <xsl:if test="ns3:Podistributionid">
                <top:poDistributionId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Podistributionid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Podistributionid"/>
                </top:poDistributionId>
                </xsl:if>
                <xsl:if test="ns3:Podistributionnum">
                <top:poDistributionNum>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Podistributionnum/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Podistributionnum"/>
                </top:poDistributionNum>
                </xsl:if>
                <xsl:if test="ns3:Pounitofmeasure">
                <top:poUnitOfMeasure>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Pounitofmeasure/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Pounitofmeasure"/>
                </top:poUnitOfMeasure>
                </xsl:if>
                <xsl:if test="ns3:Inventoryitemid">
                <top:inventoryItemId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Inventoryitemid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Inventoryitemid"/>
                </top:inventoryItemId>
                </xsl:if>
                <xsl:if test="ns3:Itemdescription">
                <top:itemDescription>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Itemdescription/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Itemdescription"/>
                </top:itemDescription>
                </xsl:if>
                <xsl:if test="ns3:Quantityinvoiced">
                <top:quantityInvoiced>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Quantityinvoiced/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Quantityinvoiced"/>
                </top:quantityInvoiced>
                </xsl:if>
                <xsl:if test="ns3:Shiptolocationcode">
                <top:shipToLocationCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Shiptolocationcode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Shiptolocationcode"/>
                </top:shipToLocationCode>
                </xsl:if>
                <xsl:if test="ns3:Unitprice">
                <top:unitPrice>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Unitprice/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Unitprice"/>
                </top:unitPrice>
                </xsl:if>
                <xsl:if test="ns3:Distributionsetid">
                <top:distributionSetId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Distributionsetid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Distributionsetid"/>
                </top:distributionSetId>
                </xsl:if>
                <xsl:if test="ns3:Distributionsetname">
                <top:distributionSetName>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Distributionsetname/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Distributionsetname"/>
                </top:distributionSetName>
                </xsl:if>
                <xsl:if test="ns3:Distcodeconcatenated">
                <top:distCodeConcatenated>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Distcodeconcatenated/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Distcodeconcatenated"/>
                </top:distCodeConcatenated>
                </xsl:if>
                <xsl:if test="ns3:Distcodecombinationid">
                <top:distCodeCombinationId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Distcodecombinationid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Distcodecombinationid"/>
                </top:distCodeCombinationId>
                </xsl:if>
                <xsl:if test="ns3:Awtgroupid">
                <top:awtGroupId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Awtgroupid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Awtgroupid"/>
                </top:awtGroupId>
                </xsl:if>
                <xsl:if test="ns3:Awtgroupname">
                <top:awtGroupName>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Awtgroupname/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Awtgroupname"/>
                </top:awtGroupName>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:AttributeCategory">
                  <top:attributeCategory>
                    <xsl:if test="ns3:LineDFF/ns2:AttributeCategory/@xsi:nil">
                      <xsl:attribute name="xsi:nil">
                        <xsl:value-of select="ns3:LineDFF/ns2:AttributeCategory/@xsi:nil"/>
                      </xsl:attribute>
                    </xsl:if>
                    <xsl:value-of select="ns3:LineDFF/ns2:AttributeCategory"/>
                  </top:attributeCategory>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute1">
                <top:attribute1>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute1"/>
                </top:attribute1>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute2">
                <top:attribute2>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute2"/>
                </top:attribute2>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute3">
                <top:attribute3>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute3"/>
                </top:attribute3>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute4">
                <top:attribute4>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute4"/>
                </top:attribute4>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute5">
                <top:attribute5>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute5"/>
                </top:attribute5>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute6">
                <top:attribute6>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute6"/>
                </top:attribute6>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute7">
                <top:attribute7>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute7"/>
                </top:attribute7>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute8">
                <top:attribute8>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute8"/>
                </top:attribute8>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute9">
                <top:attribute9>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute9"/>
                </top:attribute9>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute10">
                <top:attribute10>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute10"/>
                </top:attribute10>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute11">
                <top:attribute11>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute11"/>
                </top:attribute11>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute12">
                <top:attribute12>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute12"/>
                </top:attribute12>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute13">
                <top:attribute13>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute13"/>
                </top:attribute13>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute14">
                <top:attribute14>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute14"/>
                </top:attribute14>
                </xsl:if>
                <xsl:if test="ns3:LineDFF/ns2:Attribute15">
                <top:attribute15>
                  <xsl:value-of select="ns3:LineDFF/ns2:Attribute15"/>
                </top:attribute15>
                </xsl:if>
                <xsl:if test="ns3:Globalattributecategory">
                <top:globalAttributeCategory>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattributecategory/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattributecategory"/>
                </top:globalAttributeCategory>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute1">
                <top:globalAttribute1>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute1/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute1"/>
                </top:globalAttribute1>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute2">
                <top:globalAttribute2>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute2/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute2"/>
                </top:globalAttribute2>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute3">
                <top:globalAttribute3>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute3/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute3"/>
                </top:globalAttribute3>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute4">
                <top:globalAttribute4>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute4/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute4"/>
                </top:globalAttribute4>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute5">
                <top:globalAttribute5>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute5/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute5"/>
                </top:globalAttribute5>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute6">
                <top:globalAttribute6>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute6/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute6"/>
                </top:globalAttribute6>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute7">
                <top:globalAttribute7>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute7/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute7"/>
                </top:globalAttribute7>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute8">
                <top:globalAttribute8>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute8/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute8"/>
                </top:globalAttribute8>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute9">
                <top:globalAttribute9>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute9/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute9"/>
                </top:globalAttribute9>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute10">
                <top:globalAttribute10>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute10/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute10"/>
                </top:globalAttribute10>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute11">
                <top:globalAttribute11>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute11/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute11"/>
                </top:globalAttribute11>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute12">
                <top:globalAttribute12>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute12/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute12"/>
                </top:globalAttribute12>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute13">
                <top:globalAttribute13>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute13/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute13"/>
                </top:globalAttribute13>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute14">
                <top:globalAttribute14>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute14/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute14"/>
                </top:globalAttribute14>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute15">
                <top:globalAttribute15>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute15/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute15"/>
                </top:globalAttribute15>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute16">
                <top:globalAttribute16>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute16/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute16"/>
                </top:globalAttribute16>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute17">
                <top:globalAttribute17>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute17/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute17"/>
                </top:globalAttribute17>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute18">
                <top:globalAttribute18>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute18/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute18"/>
                </top:globalAttribute18>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute19">
                <top:globalAttribute19>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute19/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute19"/>
                </top:globalAttribute19>
                </xsl:if>
                <xsl:if test="ns3:Globalattribute20">
                <top:globalAttribute20>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Globalattribute20/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Globalattribute20"/>
                </top:globalAttribute20>
                </xsl:if>
                <xsl:if test="ns3:Poreleaseid">
                <top:poReleaseId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Poreleaseid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Poreleaseid"/>
                </top:poReleaseId>
                </xsl:if>
                <xsl:if test="ns3:Releasenum">
                <top:releaseNum>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Releasenum/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Releasenum"/>
                </top:releaseNum>
                </xsl:if>
                <xsl:if test="ns3:Accountsegment">
                <top:accountSegment>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Accountsegment/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Accountsegment"/>
                </top:accountSegment>
                </xsl:if>
                <xsl:if test="ns3:Balancingsegment">
                <top:balancingSegment>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Balancingsegment/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Balancingsegment"/>
                </top:balancingSegment>
                </xsl:if>
                <xsl:if test="ns3:Costcentersegment">
                <top:costCenterSegment>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Costcentersegment/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Costcentersegment"/>
                </top:costCenterSegment>
                </xsl:if>
                <xsl:if test="ns3:Projectid">
                <top:projectId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Projectid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Projectid"/>
                </top:projectId>
                </xsl:if>
                <xsl:if test="ns3:Taskid">
                <top:taskId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taskid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taskid"/>
                </top:taskId>
                </xsl:if>
                <xsl:if test="ns3:Expendituretype">
                <top:expenditureType>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Expendituretype/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Expendituretype"/>
                </top:expenditureType>
                </xsl:if>
                <xsl:if test="ns3:Expenditureitemdate">
                <top:expenditureItemDate>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Expenditureitemdate/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Expenditureitemdate"/>
                </top:expenditureItemDate>
                </xsl:if>
                <xsl:if test="ns3:Expenditureorganizationid">
                <top:expenditureOrganizationId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Expenditureorganizationid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Expenditureorganizationid"/>
                </top:expenditureOrganizationId>
                </xsl:if>
                <xsl:if test="ns3:Projectaccountingcontext">
                <top:projectAccountingContext>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Projectaccountingcontext/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Projectaccountingcontext"/>
                </top:projectAccountingContext>
                </xsl:if>
                <xsl:if test="ns3:Paadditionflag">
                <top:paAdditionFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Paadditionflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Paadditionflag"/>
                </top:paAdditionFlag>
                </xsl:if>
                <xsl:if test="ns3:Paquantity">
                <top:paQuantity>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Paquantity/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Paquantity"/>
                </top:paQuantity>
                </xsl:if>
                <xsl:if test="ns3:Ussgltransactioncode">
                <top:ussglTransactionCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Ussgltransactioncode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Ussgltransactioncode"/>
                </top:ussglTransactionCode>
                </xsl:if>
                <xsl:if test="ns3:Statamount">
                <top:statAmount>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Statamount/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Statamount"/>
                </top:statAmount>
                </xsl:if>
                <xsl:if test="ns3:Type1099">
                <top:type1099>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Type1099/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Type1099"/>
                </top:type1099>
                </xsl:if>
                <xsl:if test="ns3:Incometaxregion">
                <top:incomeTaxRegion>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Incometaxregion/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Incometaxregion"/>
                </top:incomeTaxRegion>
                </xsl:if>
                <xsl:if test="ns3:Assetstrackingflag">
                <top:assetsTrackingFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Assetstrackingflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Assetstrackingflag"/>
                </top:assetsTrackingFlag>
                </xsl:if>
                <xsl:if test="ns3:Pricecorrectionflag">
                <top:priceCorrectionFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Pricecorrectionflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Pricecorrectionflag"/>
                </top:priceCorrectionFlag>
                </xsl:if>
                <xsl:if test="ns3:Orgid">
                <top:orgId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Orgid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Orgid"/>
                </top:orgId>
                </xsl:if>
                <xsl:if test="ns3:Receiptnumber">
                <top:receiptNumber>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Receiptnumber/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Receiptnumber"/>
                </top:receiptNumber>
                </xsl:if>
                <xsl:if test="ns3:Receiptlinenumber">
                <top:receiptLineNumber>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Receiptlinenumber/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Receiptlinenumber"/>
                </top:receiptLineNumber>
                </xsl:if>
                <xsl:if test="ns3:Matchoption">
                <top:matchOption>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Matchoption/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Matchoption"/>
                </top:matchOption>
                </xsl:if>
                <xsl:if test="ns3:Packingslip">
                <top:packingSlip>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Packingslip/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Packingslip"/>
                </top:packingSlip>
                </xsl:if>
                <xsl:if test="ns3:Rcvtransactionid">
                <top:rcvTransactionId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Rcvtransactionid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Rcvtransactionid"/>
                </top:rcvTransactionId>
                </xsl:if>
                <xsl:if test="ns3:Paccarinvoiceid">
                <top:paCcArInvoiceId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Paccarinvoiceid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Paccarinvoiceid"/>
                </top:paCcArInvoiceId>
                </xsl:if>
                <xsl:if test="ns3:Paccarinvoicelinenum">
                <top:paCcArInvoiceLineNum>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Paccarinvoicelinenum/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Paccarinvoicelinenum"/>
                </top:paCcArInvoiceLineNum>
                </xsl:if>
                <xsl:if test="ns3:Reference1">
                <top:reference1>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Reference1/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Reference1"/>
                </top:reference1>
                </xsl:if>
                <xsl:if test="ns3:Reference2">
                <top:reference2>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Reference2/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Reference2"/>
                </top:reference2>
                </xsl:if>
                <xsl:if test="ns3:Paccprocessedcode">
                <top:paCcProcessedCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Paccprocessedcode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Paccprocessedcode"/>
                </top:paCcProcessedCode>
                </xsl:if>
                <xsl:if test="ns3:Taxrecoveryrate">
                <top:taxRecoveryRate>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxrecoveryrate/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxrecoveryrate"/>
                </top:taxRecoveryRate>
                </xsl:if>
                <xsl:if test="ns3:Taxrecoveryoverrideflag">
                <top:taxRecoveryOverrideFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxrecoveryoverrideflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxrecoveryoverrideflag"/>
                </top:taxRecoveryOverrideFlag>
                </xsl:if>
                <xsl:if test="ns3:Taxrecoverableflag">
                <top:taxRecoverableFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxrecoverableflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxrecoverableflag"/>
                </top:taxRecoverableFlag>
                </xsl:if>
                <xsl:if test="ns3:Taxcodeoverrideflag">
                <top:taxCodeOverrideFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxcodeoverrideflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxcodeoverrideflag"/>
                </top:taxCodeOverrideFlag>
                </xsl:if>
                <xsl:if test="ns3:Taxcodeid">
                <top:taxCodeId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxcodeid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxcodeid"/>
                </top:taxCodeId>
                </xsl:if>
                <xsl:if test="ns3:Creditcardtrxid">
                <top:creditCardTrxId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Creditcardtrxid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Creditcardtrxid"/>
                </top:creditCardTrxId>
                </xsl:if>
                <xsl:if test="ns3:Awardid">
                <top:awardId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Awardid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Awardid"/>
                </top:awardId>
                </xsl:if>
                <xsl:if test="ns3:Vendoritemnum">
                <top:vendorItemNum>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Vendoritemnum/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Vendoritemnum"/>
                </top:vendorItemNum>
                </xsl:if>
                <xsl:if test="ns3:Taxableflag">
                <top:taxableFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxableflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxableflag"/>
                </top:taxableFlag>
                </xsl:if>
                <xsl:if test="ns3:Pricecorrectinvnum">
                <top:priceCorrectInvNum>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Pricecorrectinvnum/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Pricecorrectinvnum"/>
                </top:priceCorrectInvNum>
                </xsl:if>
                <xsl:if test="ns3:Externaldoclineref">
                <top:externalDocLineRef>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Externaldoclineref/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Externaldoclineref"/>
                </top:externalDocLineRef>
                </xsl:if>
                <xsl:if test="ns3:Serialnumber">
                <top:serialNumber>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Serialnumber/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Serialnumber"/>
                </top:serialNumber>
                </xsl:if>
                <xsl:if test="ns3:Manufacturer">
                <top:manufacturer>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Manufacturer/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Manufacturer"/>
                </top:manufacturer>
                </xsl:if>
                <xsl:if test="ns3:Modelnumber">
                <top:modelNumber>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Modelnumber/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Modelnumber"/>
                </top:modelNumber>
                </xsl:if>
                <xsl:if test="ns3:Warrantynumber">
                <top:warrantyNumber>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Warrantynumber/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Warrantynumber"/>
                </top:warrantyNumber>
                </xsl:if>
                <xsl:if test="ns3:Deferredacctgflag">
                <top:deferredAcctgFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Deferredacctgflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Deferredacctgflag"/>
                </top:deferredAcctgFlag>
                </xsl:if>
                <xsl:if test="ns3:Defacctgstartdate">
                <top:defAcctgStartDate>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Defacctgstartdate/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Defacctgstartdate"/>
                </top:defAcctgStartDate>
                </xsl:if>
                <xsl:if test="ns3:Defacctgenddate">
                <top:defAcctgEndDate>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Defacctgenddate/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Defacctgenddate"/>
                </top:defAcctgEndDate>
                </xsl:if>
                <xsl:if test="ns3:Defacctgnumberofperiods">
                <top:defAcctgNumberOfPeriods>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Defacctgnumberofperiods/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Defacctgnumberofperiods"/>
                </top:defAcctgNumberOfPeriods>
                </xsl:if>
                <xsl:if test="ns3:Defacctgperiodtype">
                <top:defAcctgPeriodType>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Defacctgperiodtype/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Defacctgperiodtype"/>
                </top:defAcctgPeriodType>
                </xsl:if>
                <xsl:if test="ns3:Unitofmeaslookupcode">
                <top:unitOfMeasLookupCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Unitofmeaslookupcode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Unitofmeaslookupcode"/>
                </top:unitOfMeasLookupCode>
                </xsl:if>
                <xsl:if test="ns3:Pricecorrectinvlinenum">
                <top:priceCorrectInvLineNum>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Pricecorrectinvlinenum/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Pricecorrectinvlinenum"/>
                </top:priceCorrectInvLineNum>
                </xsl:if>
                <xsl:if test="ns3:Assetbooktypecode">
                <top:assetBookTypeCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Assetbooktypecode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Assetbooktypecode"/>
                </top:assetBookTypeCode>
                </xsl:if>
                <xsl:if test="ns3:Assetcategoryid">
                <top:assetCategoryId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Assetcategoryid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Assetcategoryid"/>
                </top:assetCategoryId>
                </xsl:if>
                <xsl:if test="ns3:Requesterid">
                <top:requesterId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Requesterid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Requesterid"/>
                </top:requesterId>
                </xsl:if>
                <xsl:if test="ns3:Requesterfirstname">
                <top:requesterFirstName>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Requesterfirstname/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Requesterfirstname"/>
                </top:requesterFirstName>
                </xsl:if>
                <xsl:if test="ns3:Requesterlastname">
                <top:requesterLastName>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Requesterlastname/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Requesterlastname"/>
                </top:requesterLastName>
                </xsl:if>
                <xsl:if test="ns3:Requesteremployeenum">
                <top:requesterEmployeeNum>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Requesteremployeenum/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Requesteremployeenum"/>
                </top:requesterEmployeeNum>
                </xsl:if>
                <xsl:if test="ns3:Applicationid">
                <top:applicationId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Applicationid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Applicationid"/>
                </top:applicationId>
                </xsl:if>
                <xsl:if test="ns3:Producttable">
                <top:productTable>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Producttable/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Producttable"/>
                </top:productTable>
                </xsl:if>
                <xsl:if test="ns3:Referencekey1">
                <top:referenceKey1>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Referencekey1/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Referencekey1"/>
                </top:referenceKey1>
                </xsl:if>
                <xsl:if test="ns3:Referencekey2">
                <top:referenceKey2>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Referencekey2/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Referencekey2"/>
                </top:referenceKey2>
                </xsl:if>
                <xsl:if test="ns3:Referencekey3">
                <top:referenceKey3>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Referencekey3/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Referencekey3"/>
                </top:referenceKey3>
                </xsl:if>
                <xsl:if test="ns3:Referencekey4">
                <top:referenceKey4>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Referencekey4/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Referencekey4"/>
                </top:referenceKey4>
                </xsl:if>
                <xsl:if test="ns3:Referencekey5">
                <top:referenceKey5>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Referencekey5/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Referencekey5"/>
                </top:referenceKey5>
                </xsl:if>
                <xsl:if test="ns3:Purchasingcategory">
                <top:purchasingCategory>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Purchasingcategory/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Purchasingcategory"/>
                </top:purchasingCategory>
                </xsl:if>
                <xsl:if test="ns3:Purchasingcategoryid">
                <top:purchasingCategoryId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Purchasingcategoryid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Purchasingcategoryid"/>
                </top:purchasingCategoryId>
                </xsl:if>
                <xsl:if test="ns3:Costfactorid">
                <top:costFactorId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Costfactorid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Costfactorid"/>
                </top:costFactorId>
                </xsl:if>
                <xsl:if test="ns3:Costfactorname">
                <top:costFactorName>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Costfactorname/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Costfactorname"/>
                </top:costFactorName>
                </xsl:if>
                <xsl:if test="ns3:Controlamount">
                <top:controlAmount>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Controlamount/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Controlamount"/>
                </top:controlAmount>
                </xsl:if>
                <xsl:if test="ns3:Assessablevalue">
                <top:assessableValue>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Assessablevalue/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Assessablevalue"/>
                </top:assessableValue>
                </xsl:if>
                <xsl:if test="ns3:Defaultdistccid">
                <top:defaultDistCcid>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Defaultdistccid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Defaultdistccid"/>
                </top:defaultDistCcid>
                </xsl:if>
                <xsl:if test="ns3:Primaryintendeduse">
                <top:primaryIntendedUse>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Primaryintendeduse/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Primaryintendeduse"/>
                </top:primaryIntendedUse>
                </xsl:if>
                <xsl:if test="ns3:Shiptolocationid">
                <top:shipToLocationId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Shiptolocationid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Shiptolocationid"/>
                </top:shipToLocationId>
                </xsl:if>
                <xsl:if test="ns3:Producttype">
                <top:productType>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Producttype/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Producttype"/>
                </top:productType>
                </xsl:if>
                <xsl:if test="ns3:Productcategory">
                <top:productCategory>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Productcategory/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Productcategory"/>
                </top:productCategory>
                </xsl:if>
                <xsl:if test="ns3:Productfiscclassification">
                <top:productFiscClassification>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Productfiscclassification/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Productfiscclassification"/>
                </top:productFiscClassification>
                </xsl:if>
                <xsl:if test="ns3:Userdefinedfiscclass">
                <top:userDefinedFiscClass>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Userdefinedfiscclass/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Userdefinedfiscclass"/>
                </top:userDefinedFiscClass>
                </xsl:if>
                <xsl:if test="ns3:Trxbusinesscategory">
                <top:trxBusinessCategory>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Trxbusinesscategory/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Trxbusinesscategory"/>
                </top:trxBusinessCategory>
                </xsl:if>
                <xsl:if test="ns3:Taxregimecode">
                <top:taxRegimeCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxregimecode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxregimecode"/>
                </top:taxRegimeCode>
                </xsl:if>
                <xsl:if test="ns3:Tax">
                <top:tax>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Tax/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Tax"/>
                </top:tax>
                </xsl:if>
                <xsl:if test="ns3:Taxjurisdictioncode">
                <top:taxJurisdictionCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxjurisdictioncode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxjurisdictioncode"/>
                </top:taxJurisdictionCode>
                </xsl:if>
                <xsl:if test="ns3:Taxstatuscode">
                <top:taxStatusCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxstatuscode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxstatuscode"/>
                </top:taxStatusCode>
                </xsl:if>
                <xsl:if test="ns3:Taxrateid">
                <top:taxRateId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxrateid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxrateid"/>
                </top:taxRateId>
                </xsl:if>
                <xsl:if test="ns3:Taxratecode">
                <top:taxRateCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxratecode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxratecode"/>
                </top:taxRateCode>
                </xsl:if>
                <xsl:if test="ns3:Taxrate">
                <top:taxRate>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxrate/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxrate"/>
                </top:taxRate>
                </xsl:if>
                <xsl:if test="ns3:Inclintaxablelineflag">
                <top:inclInTaxableLineFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Inclintaxablelineflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Inclintaxablelineflag"/>
                </top:inclInTaxableLineFlag>
                </xsl:if>
                <xsl:if test="ns3:Sourceapplicationid">
                <top:sourceApplicationId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Sourceapplicationid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Sourceapplicationid"/>
                </top:sourceApplicationId>
                </xsl:if>
                <xsl:if test="ns3:Sourceentitycode">
                <top:sourceEntityCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Sourceentitycode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Sourceentitycode"/>
                </top:sourceEntityCode>
                </xsl:if>
                <xsl:if test="ns3:Sourceeventclasscode">
                <top:sourceEventClassCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Sourceeventclasscode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Sourceeventclasscode"/>
                </top:sourceEventClassCode>
                </xsl:if>
                <xsl:if test="ns3:Sourcetrxid">
                <top:sourceTrxId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Sourcetrxid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Sourcetrxid"/>
                </top:sourceTrxId>
                </xsl:if>
                <xsl:if test="ns3:Sourcelineid">
                <top:sourceLineId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Sourcelineid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Sourcelineid"/>
                </top:sourceLineId>
                </xsl:if>
                <xsl:if test="ns3:Sourcetrxleveltype">
                <top:sourceTrxLevelType>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Sourcetrxleveltype/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Sourcetrxleveltype"/>
                </top:sourceTrxLevelType>
                </xsl:if>
                <xsl:if test="ns3:Taxclassificationcode">
                <top:taxClassificationCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Taxclassificationcode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Taxclassificationcode"/>
                </top:taxClassificationCode>
                </xsl:if>
                <xsl:if test="ns3:Ccreversalflag">
                <top:ccReversalFlag>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Ccreversalflag/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Ccreversalflag"/>
                </top:ccReversalFlag>
                </xsl:if>
                <xsl:if test="ns3:Companyprepaidinvoiceid">
                <top:companyPrepaidInvoiceId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Companyprepaidinvoiceid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Companyprepaidinvoiceid"/>
                </top:companyPrepaidInvoiceId>
                </xsl:if>
                <xsl:if test="ns3:Expensegroup">
                <top:expenseGroup>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Expensegroup/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Expensegroup"/>
                </top:expenseGroup>
                </xsl:if>
                <xsl:if test="ns3:Justification">
                <top:justification>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Justification/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Justification"/>
                </top:justification>
                </xsl:if>
                <xsl:if test="ns3:Merchantdocumentnumber">
                <top:merchantDocumentNumber>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Merchantdocumentnumber/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Merchantdocumentnumber"/>
                </top:merchantDocumentNumber>
                </xsl:if>
                <xsl:if test="ns3:Merchantname">
                <top:merchantName>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Merchantname/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Merchantname"/>
                </top:merchantName>
                </xsl:if>
                <xsl:if test="ns3:Merchantreference">
                <top:merchantReference>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Merchantreference/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Merchantreference"/>
                </top:merchantReference>
                </xsl:if>
                <xsl:if test="ns3:Merchanttaxregnumber">
                <top:merchantTaxRegNumber>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Merchanttaxregnumber/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Merchanttaxregnumber"/>
                </top:merchantTaxRegNumber>
                </xsl:if>
                <xsl:if test="ns3:Merchanttaxpayerid">
                <top:merchantTaxpayerId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Merchanttaxpayerid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Merchanttaxpayerid"/>
                </top:merchantTaxpayerId>
                </xsl:if>
                <xsl:if test="ns3:Receiptcurrencycode">
                <top:receiptCurrencyCode>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Receiptcurrencycode/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Receiptcurrencycode"/>
                </top:receiptCurrencyCode>
                </xsl:if>
                <xsl:if test="ns3:Receiptconversionrate">
                <top:receiptConversionRate>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Receiptconversionrate/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Receiptconversionrate"/>
                </top:receiptConversionRate>
                </xsl:if>
                <xsl:if test="ns3:Receiptcurrencyamount">
                <top:receiptCurrencyAmount>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Receiptcurrencyamount/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Receiptcurrencyamount"/>
                </top:receiptCurrencyAmount>
                </xsl:if>
                <xsl:if test="ns3:Countryofsupply">
                <top:countryOfSupply>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Countryofsupply/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Countryofsupply"/>
                </top:countryOfSupply>
                </xsl:if>
                <xsl:if test="ns3:Payawtgroupid">
                <top:payAwtGroupId>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Payawtgroupid/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Payawtgroupid"/>
                </top:payAwtGroupId>
                </xsl:if>
                <xsl:if test="ns3:Payawtgroupname">
                <top:payAwtGroupName>
                  <xsl:attribute name="xsi:nil">
                    <xsl:value-of select="ns3:Payawtgroupname/@xsi:nil"/>
                  </xsl:attribute>
                  <xsl:value-of select="ns3:Payawtgroupname"/>
                </top:payAwtGroupName>
                </xsl:if>
              </top:ApInvoiceLinesInterface>
            </xsl:for-each>
          </top:apInvoiceLinesInterfaceCollection>
        </top:ApInvoicesInterface>
      </xsl:for-each>
    </top:ApInvoicesInterfaceCollection>
  </xsl:template>
</xsl:stylesheet>
